"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var chai = require("chai");
var types_1 = require("@0x/types");
var utils_1 = require("@0x/utils");
var asset_data_utils_1 = require("../src/asset_data_utils");
var chai_setup_1 = require("./utils/chai_setup");
chai_setup_1.chaiSetup.configure();
var expect = chai.expect;
var KNOWN_ERC20_ENCODING = {
    address: '0x1dc4c1cefef38a777b15aa20260a54e584b16c48',
    assetData: '0xf47261b00000000000000000000000001dc4c1cefef38a777b15aa20260a54e584b16c48',
};
var KNOWN_ERC721_ENCODING = {
    address: '0x1dc4c1cefef38a777b15aa20260a54e584b16c48',
    tokenId: new utils_1.BigNumber(1),
    assetData: '0x025717920000000000000000000000001dc4c1cefef38a777b15aa20260a54e584b16c480000000000000000000000000000000000000000000000000000000000000001',
};
var KNOWN_MULTI_ASSET_ENCODING = {
    amounts: [new utils_1.BigNumber(1), new utils_1.BigNumber(1)],
    nestedAssetData: [KNOWN_ERC20_ENCODING.assetData, KNOWN_ERC721_ENCODING.assetData],
    assetData: '0x94cfcdd7000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000024f47261b00000000000000000000000001dc4c1cefef38a777b15aa20260a54e584b16c48000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044025717920000000000000000000000001dc4c1cefef38a777b15aa20260a54e584b16c48000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000',
};
describe('assetDataUtils', function () {
    it('should encode ERC20', function () {
        var assetData = asset_data_utils_1.assetDataUtils.encodeERC20AssetData(KNOWN_ERC20_ENCODING.address);
        expect(assetData).to.equal(KNOWN_ERC20_ENCODING.assetData);
    });
    it('should decode ERC20', function () {
        var decodedAssetData = asset_data_utils_1.assetDataUtils.decodeERC20AssetData(KNOWN_ERC20_ENCODING.assetData);
        expect(decodedAssetData.tokenAddress).to.equal(KNOWN_ERC20_ENCODING.address);
        expect(decodedAssetData.assetProxyId).to.equal(types_1.AssetProxyId.ERC20);
    });
    it('should encode ERC721', function () {
        var assetData = asset_data_utils_1.assetDataUtils.encodeERC721AssetData(KNOWN_ERC721_ENCODING.address, KNOWN_ERC721_ENCODING.tokenId);
        expect(assetData).to.equal(KNOWN_ERC721_ENCODING.assetData);
    });
    it('should decode ERC721', function () {
        var decodedAssetData = asset_data_utils_1.assetDataUtils.decodeERC721AssetData(KNOWN_ERC721_ENCODING.assetData);
        expect(decodedAssetData.tokenAddress).to.equal(KNOWN_ERC721_ENCODING.address);
        expect(decodedAssetData.assetProxyId).to.equal(types_1.AssetProxyId.ERC721);
        expect(decodedAssetData.tokenId).to.be.bignumber.equal(KNOWN_ERC721_ENCODING.tokenId);
    });
    it('should encode ERC20 and ERC721 multiAssetData', function () {
        var assetData = asset_data_utils_1.assetDataUtils.encodeMultiAssetData(KNOWN_MULTI_ASSET_ENCODING.amounts, KNOWN_MULTI_ASSET_ENCODING.nestedAssetData);
        expect(assetData).to.equal(KNOWN_MULTI_ASSET_ENCODING.assetData);
    });
    it('should decode ERC20 and ERC721 multiAssetData', function () {
        var decodedAssetData = asset_data_utils_1.assetDataUtils.decodeMultiAssetData(KNOWN_MULTI_ASSET_ENCODING.assetData);
        expect(decodedAssetData.assetProxyId).to.equal(types_1.AssetProxyId.MultiAsset);
        expect(decodedAssetData.amounts).to.deep.equal(KNOWN_MULTI_ASSET_ENCODING.amounts);
        expect(decodedAssetData.nestedAssetData).to.deep.equal(KNOWN_MULTI_ASSET_ENCODING.nestedAssetData);
    });
    it('should recursively decode ERC20 and ERC721 multiAssetData', function () {
        var decodedAssetData = asset_data_utils_1.assetDataUtils.decodeMultiAssetDataRecursively(KNOWN_MULTI_ASSET_ENCODING.assetData);
        expect(decodedAssetData.assetProxyId).to.equal(types_1.AssetProxyId.MultiAsset);
        expect(decodedAssetData.amounts).to.deep.equal(KNOWN_MULTI_ASSET_ENCODING.amounts);
        var decodedErc20AssetData = decodedAssetData.nestedAssetData[0];
        // tslint:disable-next-line:no-unnecessary-type-assertion
        var decodedErc721AssetData = decodedAssetData.nestedAssetData[1];
        expect(decodedErc20AssetData.tokenAddress).to.equal(KNOWN_ERC20_ENCODING.address);
        expect(decodedErc20AssetData.assetProxyId).to.equal(types_1.AssetProxyId.ERC20);
        expect(decodedErc721AssetData.tokenAddress).to.equal(KNOWN_ERC721_ENCODING.address);
        expect(decodedErc721AssetData.assetProxyId).to.equal(types_1.AssetProxyId.ERC721);
        expect(decodedErc721AssetData.tokenId).to.be.bignumber.equal(KNOWN_ERC721_ENCODING.tokenId);
    });
    it('should recursively decode nested assetData within multiAssetData', function () {
        var amounts = [new utils_1.BigNumber(1), new utils_1.BigNumber(1), new utils_1.BigNumber(2)];
        var nestedAssetData = [
            KNOWN_ERC20_ENCODING.assetData,
            KNOWN_ERC721_ENCODING.assetData,
            KNOWN_MULTI_ASSET_ENCODING.assetData,
        ];
        var assetData = asset_data_utils_1.assetDataUtils.encodeMultiAssetData(amounts, nestedAssetData);
        var decodedAssetData = asset_data_utils_1.assetDataUtils.decodeMultiAssetDataRecursively(assetData);
        expect(decodedAssetData.assetProxyId).to.equal(types_1.AssetProxyId.MultiAsset);
        var expectedAmounts = [new utils_1.BigNumber(1), new utils_1.BigNumber(1), new utils_1.BigNumber(2), new utils_1.BigNumber(2)];
        expect(decodedAssetData.amounts).to.deep.equal(expectedAmounts);
        var expectedLength = 4;
        expect(decodedAssetData.nestedAssetData.length).to.be.equal(expectedLength);
        var decodedErc20AssetData1 = decodedAssetData.nestedAssetData[0];
        // tslint:disable-next-line:no-unnecessary-type-assertion
        var decodedErc721AssetData1 = decodedAssetData.nestedAssetData[1];
        var decodedErc20AssetData2 = decodedAssetData.nestedAssetData[2];
        // tslint:disable-next-line:no-unnecessary-type-assertion
        var decodedErc721AssetData2 = decodedAssetData.nestedAssetData[3];
        expect(decodedErc20AssetData1.tokenAddress).to.equal(KNOWN_ERC20_ENCODING.address);
        expect(decodedErc20AssetData1.assetProxyId).to.equal(types_1.AssetProxyId.ERC20);
        expect(decodedErc721AssetData1.tokenAddress).to.equal(KNOWN_ERC721_ENCODING.address);
        expect(decodedErc721AssetData1.assetProxyId).to.equal(types_1.AssetProxyId.ERC721);
        expect(decodedErc721AssetData1.tokenId).to.be.bignumber.equal(KNOWN_ERC721_ENCODING.tokenId);
        expect(decodedErc20AssetData2.tokenAddress).to.equal(KNOWN_ERC20_ENCODING.address);
        expect(decodedErc20AssetData2.assetProxyId).to.equal(types_1.AssetProxyId.ERC20);
        expect(decodedErc721AssetData2.tokenAddress).to.equal(KNOWN_ERC721_ENCODING.address);
        expect(decodedErc721AssetData2.assetProxyId).to.equal(types_1.AssetProxyId.ERC721);
        expect(decodedErc721AssetData2.tokenId).to.be.bignumber.equal(KNOWN_ERC721_ENCODING.tokenId);
    });
});
//# sourceMappingURL=asset_data_utils_test.js.map